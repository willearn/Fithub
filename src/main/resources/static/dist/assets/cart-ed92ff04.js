import{_ as j,P as E,s as D,Q as V,r as g,U as Y,V as q,o as R,b as d,d as u,F as U,h as P,f as t,t as c,g as z,W as Q,l as G,j as I,p as H,k as K,a as X,u as ct,w as M,c as at,O as nt,x as it,e as B,J as O,q as rt,E as T,y as dt}from"./index-e86ed1bf.js";import{_ as ut}from"./progressbar-44c16b0d.js";const ht=_=>(H("data-v-6b09a1b3"),_=_(),K(),_),_t={class:"table align-middle text-center"},pt=ht(()=>t("thead",{class:"table-light"},[t("tr",null,[t("th",{scope:"col"},"#"),t("th",{scope:"col"},"課程圖片"),t("th",{scope:"col"},"課程名稱"),t("th",{scope:"col"},"課程教練"),t("th",{scope:"col"},"課程時間"),t("th",{scope:"col"},"單價"),t("th",{scope:"col"})])],-1)),vt={scope:"row"},bt=["src"],gt=["onClick"],mt=["onClick"],ft={__name:"courseWishlist",setup(_){const p="http://localhost:8080/fithub",b=E(),{courseCartStore:n}=D(b),o=V(),{courseWishlistStore:m}=D(o),i=g([]),v=async()=>{if(localStorage.getItem("memberid")!=null){const a=`${p}/classes/findAllClassesInMemberWishlist`,r=await I.get(a,{params:{memberId:localStorage.getItem("memberid")}}).catch(e=>{console.log(e.toJSON())});i.value=r.data,S(i)}},k=g(!1),y=()=>{k.value=!0},f=(a,r,e)=>{n.value.includes(a)?A("課程已存在您的購物車"):(n.value.push(a),$(a,r,e),A("已成功加入您的購物車"))},S=a=>{let r=[];for(let e=0;e<a.value.length;e++)r.push(a.value[e].classId);m.value=r},$=async(a,r,e)=>{await I.put(`${p}/wishlist/${r}`,{listId:r,memberId:localStorage.getItem("memberid"),classId:a,wishAddSince:e}).catch(w=>{console.log(w.toJSON())}),v(),A("已取消您的願望收藏")};Y();const W=q(),A=a=>{W.info(a,{closable:!0,duration:5e3})};return R(()=>{v()}),(a,r)=>(d(),u("table",_t,[pt,(d(!0),u(U,null,P(i.value,(e,w)=>(d(),u("tbody",null,[t("tr",null,[t("th",vt,c(w+1),1),t("td",null,[z(t("img",{src:`${G(p)}/course/getImg?cid=${e.courseId}`,class:"cart-img-left mt-3",alt:"not Found",onLoad:y},null,40,bt),[[Q,k.value]])]),t("td",null,c(e.courseName),1),t("td",null,c(e.employeename),1),t("td",null,c(e.classDate)+" "+c(e.classTime),1),t("td",null,"NT$  "+c(e.price.toLocaleString()),1),t("td",null,[t("div",{type:"button",class:"bi bi-cart2",onClick:x=>f(e.classId,e.listId,e.wishAddSince)},null,8,gt),t("div",{type:"button",class:"bi bi-trash-fill",onClick:x=>$(e.classId,e.listId,e.wishAddSince)},null,8,mt)])])]))),256))]))}},Ct=j(ft,[["__scopeId","data-v-6b09a1b3"]]),It={class:"table table-bordered"},yt=t("thead",{class:"align-middle text-center"},[t("tr",null,[t("th",null,"名稱"),t("th",null,"優惠碼"),t("th",null,"截止日期"),t("th",null,"使用門檻"),t("th",null,"優惠券折扣"),t("th",null,"已使用量")])],-1),St={class:"align-middle text-center"},$t={class:"text-primary"},At={__name:"memberCoupon",setup(_){const p="http://localhost:8080/fithub";X({couponcategoriesid:"",couponname:"",couponstate:"",coupongeneratedate:"",couponenddate:"",couponcode:"",couponamount:"",couponceil:"",coupondiscount:"",couponused:"",couponthreshold:""});const b=g([]),n=async()=>{try{const o=await I.get(`${p}/coupons`);b.value=o.data,console.log(b.value)}catch(o){console.error("Error getcoupons data:",o)}};return R(()=>{n()}),(o,m)=>(d(),u("table",It,[yt,t("tbody",St,[(d(!0),u(U,null,P(b.value,(i,v)=>(d(),u("tr",{key:v},[t("td",null,c(i.couponname),1),t("td",$t,c(i.couponcode),1),t("td",null,c(i.couponenddate),1),t("td",null,c(i.couponthreshold),1),t("td",null,c(i.coupondiscount),1),t("td",null,c((i.couponused/i.couponceil*100).toFixed(2))+"% ",1)]))),128))])]))}};const F=_=>(H("data-v-696e9d20"),_=_(),K(),_),wt={class:"page-section",style:{"padding-top":"5%","padding-bottom":"5%"}},kt={class:"container"},Ot={class:"row justify-content-center mb-5"},Dt={class:"col-12 col-md-6 col-lg-6"},Wt={class:"row justify-content-center"},xt={class:"col-11 col-md-9 col-lg-8"},Nt={class:"p-2 bg-light border"},Lt={class:"nav nav-tabs"},Bt={class:"nav-item"},Tt={class:"nav-item"},Rt={class:"nav-item"},Ut={class:"p-2 bg-light border"},Pt={key:0,class:"table align-middle text-center"},Ft=F(()=>t("thead",{class:"table-light"},[t("tr",null,[t("th",{scope:"col"},"#"),t("th",{scope:"col"},"課程圖片"),t("th",{scope:"col"},"課程名稱"),t("th",{scope:"col"},"課程教練"),t("th",{scope:"col"},"課程時間"),t("th",{scope:"col"},"單價"),t("th",{scope:"col"})])],-1)),Jt={scope:"row"},Mt=["src"],jt=["onClick"],Et=["onClick"],Vt={class:"p-2 bg-light border"},Yt={key:0,class:"rol-12 rol-md-9 row-lg-8"},qt={key:0,class:"col-12 col-md-3 col-lg-2"},zt={class:"card"},Qt={class:"card-body"},Gt=F(()=>t("h4",{class:"card-title"},"總價:",-1)),Ht={class:"card-text"},Kt={class:"d-grid gap-3 col-12 mx-auto"},Xt={class:"row justify-content-center"},Zt=F(()=>t("button",{class:"btn btn-primary"},"繼續購課",-1)),ts={__name:"cart",setup(_){const p="http://localhost:8080/fithub",b=ct(),n=g("cart"),o=X({isActiveOrDisableCart:!0,isActiveOrDisableWishlist:!1,isActiveOrDisableCoupon:!1}),m=s=>{s=="cart"?(n.value="cart",o.isActiveOrDisableCart=!0,o.isActiveOrDisableWishlist=!1,o.isActiveOrDisableCoupon=!1):s=="wishlist"?localStorage.getItem("memberid")==""?C("請先登入會員"):(n.value="wishlist",o.isActiveOrDisableCart=!1,o.isActiveOrDisableWishlist=!0,o.isActiveOrDisableCoupon=!1):(n.value="coupon",o.isActiveOrDisableCart=!1,o.isActiveOrDisableWishlist=!1,o.isActiveOrDisableCoupon=!0)};M(n,s=>{s=="cart"&&S()});const i=E(),{courseCartStore:v}=D(i),k=V(),{courseWishlistStore:y}=D(k),f=g([]),S=async()=>{const s=`${p}/classes/findClassesByIds`,l=await I.post(s,v.value).catch(L=>{console.log(L.toJSON())});f.value=l.data},$=g(!1),W=()=>{$.value=!0},A=`${p}/order-items/getOrderItemAmountByClassId`,a=s=>I.get(A,{params:{classId:s}}).catch(l=>{console.log(l.toJSON())}),r=at(()=>{let s=0;for(let l=0;l<f.value.length;l++)s+=f.value[l].price;return s}),e=s=>{v.value.splice(v.value.indexOf(s),1),C("已刪除您的購物車商品")};M(v.value,()=>{S()});const w=async s=>{await I.post(`${p}/wishlist`,{memberId:localStorage.getItem("memberid"),classId:s}).catch(l=>{console.log(l.toJSON())})},x=s=>{localStorage.getItem("memberid")==""?C("請先登入會員"):y.value.includes(s)?C("課程已存在您的願望清單"):(e(s),y.value.push(s),w(s),console.log(y.value),C("課程已成功加入願望清單"))},N=g(null),J=()=>{r.value==0?N.value=!0:N.value=!1},Z=async()=>{if(localStorage.getItem("memberid")==""){C("請先登入會員");return}for(let s of v.value){const l=await a(s);if(l.data.applicantsCeil-l.data.orderAmount<=0){et(`很抱歉，${l.data.courseName}課程已經售完囉!`),e(l.data.classId);return}}b.push("checkout")},tt=Y(),st=q(),et=s=>{tt.warning({title:"可惜了",content:s,positiveText:"確定"})},C=s=>{st.info(s,{closable:!0,duration:5e3})};return R(()=>{S(),J()}),nt(()=>{J()}),(s,l)=>{const L=it("router-link");return d(),u("section",wt,[t("div",kt,[t("div",Ot,[t("div",Dt,[B(ut,{percent:25})])]),t("div",Wt,[t("div",xt,[t("div",Nt,[t("ul",Lt,[t("li",Bt,[t("button",{class:O(["nav-link",{active:o.isActiveOrDisableCart,disabled:o.isActiveOrDisableCart}]),onClick:l[0]||(l[0]=h=>m("cart"))}," 購物車 ",2)]),t("li",Tt,[t("button",{class:O(["nav-link",{active:o.isActiveOrDisableWishlist,disabled:o.isActiveOrDisableWishlist}]),onClick:l[1]||(l[1]=h=>m("wishlist"))}," 我的願望清單 ",2)]),t("li",Rt,[t("button",{class:O(["nav-link",{active:o.isActiveOrDisableCoupon,disabled:o.isActiveOrDisableCoupon}]),onClick:l[2]||(l[2]=h=>m("coupon"))}," 折價券 ",2)])])]),t("div",Ut,[n.value=="cart"?(d(),u("table",Pt,[Ft,(d(!0),u(U,null,P(f.value,(h,ot)=>(d(),u("tbody",null,[t("tr",null,[t("th",Jt,c(ot+1),1),t("td",null,[z(t("img",{src:`${G(p)}/course/getImg?cid=${h.courseId}`,class:"cart-img-left mt-3",alt:"not Found",onLoad:W},null,40,Mt),[[Q,$.value]])]),t("td",null,c(h.courseName),1),t("td",null,c(h.employeename),1),t("td",null,c(h.classDate)+" "+c(h.classTime),1),t("td",null,"NT$  "+c(h.price.toLocaleString()),1),t("td",null,[t("div",{type:"button",class:"bi bi-heart-fill",onClick:lt=>x(h.classId)},null,8,jt),t("div",{type:"button",class:"bi bi-trash-fill",onClick:lt=>e(h.classId)},null,8,Et)])])]))),256))])):n.value=="wishlist"?(d(),rt(Ct,{key:1})):T("",!0)]),t("div",Vt,[n.value=="coupon"?(d(),u("div",Yt,[B(At)])):T("",!0)])]),n.value=="cart"?(d(),u("div",qt,[t("div",zt,[t("div",Qt,[Gt,t("p",Ht," NT$ "+c(r.value.toLocaleString()),1),t("div",Kt,[t("button",{class:O(["btn btn-primary",{disabled:N.value}]),onClick:Z}," 結帳 ",2)])])]),t("div",Xt,[B(L,{class:"col-8 my-4 text-center",to:"/course/0"},{default:dt(()=>[Zt]),_:1})])])):T("",!0)])])])}}},os=j(ts,[["__scopeId","data-v-696e9d20"]]);export{os as default};
