import{u as C,s as O,r as h,o as B,b as R,d as k,e as x,f as e,l as n,t as a,g as S,v as E,F as N,S as u,a as _,j as m}from"./index-e86ed1bf.js";import{u as D,a as P}from"./index-4e694b90.js";import{u as M}from"./rentorder-d2c30cf6.js";import{C as T}from"./Carousel-a86a19a5.js";const $={class:"page-section"},L={class:"container text-center"},Y=e("h1",null,"選擇付款方式",-1),F=e("hr",{class:"divider"},null,-1),H={class:"row justify-content-center"},U={class:"col-lg-10 col-md-12"},V={class:"table table-bordered align-middle"},j=e("thead",{class:"table-success"},[e("tr",null,[e("th",{scope:"col"}),e("th",{scope:"col"},"圖片"),e("th",{scope:"col"},"場地"),e("th",{scope:"col"},"日期"),e("th",{scope:"col"},"時段"),e("th",{scope:"col"},"金額")])],-1),q=e("td",null,"1",-1),A=["src"],I={class:"p-2 bg-light border"},W={class:"form-floating"},z=e("option",{value:"0",disabled:""},"選擇付款方式",-1),G=e("option",{value:"1"},"信用卡-綠界金流",-1),J=e("option",{value:"2"},"LINE PAY",-1),K=[z,G,J],Q=e("label",{for:"floatingSelect"},"Pay with selects",-1),X={class:"mt-5"},re={__name:"rentorder",setup(Z){const i="http://localhost:8080/fithub",f=C(),y=M(),{selectedClassroom:o}=O(y),d=h("0");function v(t){t==="0"?u.fire({title:"請選擇付款方式",icon:"warning",confirmButtonColor:"#3085d6",confirmButtonText:"確定"}):t==="1"?b():t==="2"&&g()}const b=async()=>{try{const t=D(P(),"YYYY/MM/DD HH:mm:ss"),s=_({rentorderid:"",rentorderdate:t.value,rentamount:o.value.classroomPrice,classroomname:o.value.classroomName});s.rentorderid=o.value.rentOrderid;const l=(await m.post(`${i}/ecpay/ecpayCheckout`,s)).data;console.log(l);const c=document.createElement("div");c.style.display="none",c.innerHTML=l,document.body.appendChild(c);const p=c.querySelector("form");p?p.submit():console.error("找不到表單元素")}catch(t){console.error("insertEcpayOrder Error:",t)}},g=async()=>{const t=h(null);try{const s=_({rentorderid:"",rentamount:o.value.classroomPrice,classroomname:o.value.classroomName});s.rentorderid=o.value.rentOrderid;const r=await m.post(`${i}/linepay/linepayCheckout`,s);t.value=r.data;const l=t.value.info.paymentUrl.web;window.location.href=l}catch(s){console.error("insertLineOrder Error:",s)}},w=async()=>{try{u.fire({title:"確定要取消訂單嗎？",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確定",cancelButtonText:"取消"}).then(async t=>{if(t.isConfirmed){u.fire("已取消訂單!");const s=await m.delete(`${i}/rent/delete/${o.value.rentOrderid}`);o.value=null,f.back()}})}catch(t){console.error("cancleRentOrder Error:",t)}};return B(()=>{}),(t,s)=>(R(),k(N,null,[x(T),e("section",$,[e("div",L,[Y,F,e("div",H,[e("div",U,[e("table",V,[j,e("tbody",null,[e("tr",null,[q,e("td",null,[e("img",{src:n(o).classroomPic,style:{width:"400px",height:"400px"}},null,8,A)]),e("td",null,a(n(o).classroomName),1),e("td",null,a(n(o).rentdate),1),e("td",null,a(n(o).renttime),1),e("td",null,"$NT "+a(n(o).classroomPrice.toLocaleString()),1)])])]),e("div",I,[e("div",W,[S(e("select",{"onUpdate:modelValue":s[0]||(s[0]=r=>d.value=r),class:"form-select"},K,512),[[E,d.value]]),Q])]),e("div",X,[e("button",{type:"submit",class:"btn btn-primary btn-lg",onClick:w}," 取消返回 "),e("button",{type:"submit",class:"btn btn-primary btn-lg offset-1",onClick:s[1]||(s[1]=r=>v(d.value))}," 結帳 ")])])])])])],64))}};export{re as default};
